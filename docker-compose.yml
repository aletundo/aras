version: '3.4'

services:
  gateway:
    build:
      context: gateway/
    restart: on-failure
    ports:
      - 9000:9000
    networks:
      - config-net
      - backend-net
  analyses-configurator-service:
    build:
      context:
        analyses-configurator-service/
    restart: on-failure
    networks:
      - config-net
      - backend-net
      - broker-net
  analyses-executor-service:
    build:
      context:
        analyses-executor-service/
    restart: on-failure
    networks:
      - config-net
      - backend-net
      - broker-net
  notifications-service:
    build:
      context: notifications-service/
    restart: on-failure
    networks:
      - config-net
      - backend-net
      - broker-net
      - notifications-db-net
networks:
  config-net:
    external:
      name: ${COMPOSE_PROJECT_NAME}_config-net
  broker-net:
    external:
      name: ${COMPOSE_PROJECT_NAME}_broker-net
  backend-net:
    external:
      name: ${COMPOSE_PROJECT_NAME}_backend-net
  notifications-db-net:
    external:
      name: ${COMPOSE_PROJECT_NAME}_notifications-db-net
