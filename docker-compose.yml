version: '3.4'

services:
  analyses-executor-service:
    build: 
      context: analyses-executor-service/
    environment:
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
      SPRING_PROFILE: ${SPRING_PROFILE}
      SHARED_MONGODB_URI: ${SHARED_MONGODB_URI}
  analyses-configurator-service:
    build: 
      context: analyses-configurator-service/
    environment:
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
      SPRING_PROFILE: ${SPRING_PROFILE}
  projects-service:
    build:
      context: projects-service/
    environment:
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
      SPRING_PROFILE: ${SPRING_PROFILE}
  reports-service:
    build:
      context: reports-service/
    environment:
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
      SPRING_PROFILE: ${SPRING_PROFILE}
  notifications-service:
    build: 
      context: notifications-service/
    environment:
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
      SPRING_PROFILE: ${SPRING_PROFILE}
      SHARED_MONGODB_URI: ${SHARED_MONGODB_URI}
  gateway:
    build: 
      context: gateway/
    environment:
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
      SPRING_PROFILE: ${SPRING_PROFILE}
  eureka-server:
    build: 
      context: eureka-server/
    environment:
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
      CONFIG_SERVER_PORT: ${CONFIG_SERVER_PORT}
  config-server:
    build:
      context: config-server/
    environment:
      CONFIG_SERVER_PORT: ${CONFIG_SERVER_PORT}
      EUREKA_SERVER_PORT: ${EUREKA_SERVER_PORT}
  zookeeper:
    image: wurstmeister/zookeeper
  kafka:
    image: wurstmeister/kafka:0.10.1.1
    environment:
      KAFKA_ADVERTISED_HOST_NAME: ${KAFKA_ADVERTISED_HOST_NAME}
      KAFKA_ADVERTISED_PORT: ${KAFKA_ADVERTISED_PORT}
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:${ZOOKEEPER_PORT}
      KAFKA_CREATE_TOPICS: ${KAFKA_TOPICS}
    depends_on:
      - zookeeper
